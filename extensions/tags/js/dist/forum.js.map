{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/tags/./src/common/compat.js","webpack://@flarum/tags/./src/common/helpers/tagIcon.js","webpack://@flarum/tags/./src/common/helpers/tagLabel.js","webpack://@flarum/tags/./src/common/helpers/tagsLabel.js","webpack://@flarum/tags/./src/common/models/Tag.ts","webpack://@flarum/tags/./src/common/utils/sortTags.tsx","webpack://@flarum/tags/./src/forum/addTagComposer.js","webpack://@flarum/tags/./src/forum/addTagControl.js","webpack://@flarum/tags/./src/forum/addTagFilter.tsx","webpack://@flarum/tags/./src/forum/addTagLabels.js","webpack://@flarum/tags/./src/forum/addTagList.js","webpack://@flarum/tags/./src/forum/compat.js","webpack://@flarum/tags/./src/forum/components/DiscussionTaggedPost.js","webpack://@flarum/tags/./src/forum/components/TagDiscussionModal.tsx","webpack://@flarum/tags/./src/forum/components/TagHero.js","webpack://@flarum/tags/./src/forum/components/TagLinkButton.js","webpack://@flarum/tags/./src/forum/components/TagsPage.js","webpack://@flarum/tags/./src/forum/components/ToggleButton.js","webpack://@flarum/tags/./src/forum/index.ts","webpack://@flarum/tags/./src/forum/states/TagListState.ts","webpack://@flarum/tags/./src/forum/utils/getSelectableTags.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/regenerator/index.js","webpack://@flarum/tags/../../../node_modules/regenerator-runtime/runtime.js","webpack://@flarum/tags/external assign \"flarum.core\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Component']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Model']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Separator']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/extend']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/computed']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/extract']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/isDark']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/app']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/EventPost']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/states/GlobalSearchState']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/utils/KeyboardNavigatable']\"","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flarum/tags/webpack/bootstrap","webpack://@flarum/tags/webpack/runtime/compat get default export","webpack://@flarum/tags/webpack/runtime/define property getters","webpack://@flarum/tags/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/tags/webpack/runtime/make namespace object","webpack://@flarum/tags/./forum.ts"],"sourcesContent":["import sortTags from './utils/sortTags';\nimport Tag from './models/Tag';\nimport tagsLabel from './helpers/tagsLabel';\nimport tagIcon from './helpers/tagIcon';\nimport tagLabel from './helpers/tagLabel';\n\nexport default {\n  'tags/utils/sortTags': sortTags,\n  'tags/models/Tag': Tag,\n  'tags/helpers/tagsLabel': tagsLabel,\n  'tags/helpers/tagIcon': tagIcon,\n  'tags/helpers/tagLabel': tagLabel,\n};\n","import classList from 'flarum/common/utils/classList';\n\nexport default function tagIcon(tag, attrs = {}, settings = {}) {\n  const hasIcon = tag && tag.icon();\n  const { useColor = true } = settings;\n\n  attrs.className = classList([attrs.className, 'icon', hasIcon ? tag.icon() : 'TagIcon']);\n\n  if (tag && useColor) {\n    attrs.style = attrs.style || {};\n    attrs.style['--color'] = tag.color();\n\n    if (hasIcon) {\n      attrs.style.color = tag.color();\n    }\n  } else if (!tag) {\n    attrs.className += ' untagged';\n  }\n\n  return hasIcon ? <i {...attrs} /> : <span {...attrs} />;\n}\n","import extract from 'flarum/common/utils/extract';\nimport isDark from 'flarum/common/utils/isDark';\nimport Link from 'flarum/common/components/Link';\nimport tagIcon from './tagIcon';\n\nexport default function tagLabel(tag, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'TagLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n  const tagText = tag ? tag.name() : app.translator.trans('flarum-tags.lib.deleted_tag_text');\n\n  if (tag) {\n    const color = tag.color();\n    if (color) {\n      attrs.style['--tag-bg'] = color;\n      attrs.className += ' colored';\n\n      if (isDark(color)) {\n        attrs.className += ' tag-dark';\n      }\n      else {\n        attrs.className += ' tag-light';\n      }\n    }\n\n    if (link) {\n      attrs.title = tag.description() || '';\n      attrs.href = app.route('tag', { tags: tag.slug() });\n    }\n\n    if (tag.isChild()) {\n      attrs.className += ' TagLabel--child';\n    }\n  } else {\n    attrs.className += ' untagged';\n  }\n\n  return m(\n    link ? Link : 'span',\n    attrs,\n    <span className=\"TagLabel-text\">\n      {tag && tag.icon() && tagIcon(tag, {}, { useColor: false })} {tagText}\n    </span>\n  );\n}\n","import extract from 'flarum/common/utils/extract';\nimport tagLabel from './tagLabel';\nimport sortTags from '../utils/sortTags';\n\nexport default function tagsLabel(tags, attrs = {}) {\n  const children = [];\n  const link = extract(attrs, 'link');\n\n  attrs.className = 'TagsLabel ' + (attrs.className || '');\n\n  if (tags) {\n    sortTags(tags).forEach((tag) => {\n      if (tag || tags.length === 1) {\n        children.push(tagLabel(tag, { link }));\n      }\n    });\n  } else {\n    children.push(tagLabel());\n  }\n\n  return <span {...attrs}>{children}</span>;\n}\n","import computed from 'flarum/common/utils/computed';\nimport Model from 'flarum/common/Model';\nimport type Discussion from 'flarum/common/models/Discussion';\n\nexport default class Tag extends Model {\n  name() {\n    return Model.attribute<string>('name').call(this);\n  }\n  slug() {\n    return Model.attribute<string>('slug').call(this);\n  }\n  description() {\n    return Model.attribute<string | null>('description').call(this);\n  }\n\n  color() {\n    return Model.attribute<string | null>('color').call(this);\n  }\n  backgroundUrl() {\n    return Model.attribute<string | null>('backgroundUrl').call(this);\n  }\n  backgroundMode() {\n    return Model.attribute<string | null>('backgroundMode').call(this);\n  }\n  icon() {\n    return Model.attribute<string | null>('icon').call(this);\n  }\n\n  position() {\n    return Model.attribute<number | null>('position').call(this);\n  }\n  parent() {\n    return Model.hasOne<Tag | null>('parent').call(this);\n  }\n  children() {\n    return Model.hasMany<Tag>('children').call(this);\n  }\n  defaultSort() {\n    return Model.attribute<string | null>('defaultSort').call(this);\n  }\n  isChild() {\n    return Model.attribute<boolean>('isChild').call(this);\n  }\n  isHidden() {\n    return Model.attribute<boolean>('isHidden').call(this);\n  }\n\n  discussionCount() {\n    return Model.attribute<number>('discussionCount').call(this);\n  }\n  lastPostedAt() {\n    return Model.attribute('lastPostedAt', Model.transformDate).call(this);\n  }\n  lastPostedDiscussion() {\n    return Model.hasOne<Discussion | null>('lastPostedDiscussion').call(this);\n  }\n\n  isRestricted() {\n    return Model.attribute<boolean>('isRestricted').call(this);\n  }\n  canStartDiscussion() {\n    return Model.attribute<boolean>('canStartDiscussion').call(this);\n  }\n  canAddToDiscussion() {\n    return Model.attribute<boolean>('canAddToDiscussion').call(this);\n  }\n\n  isPrimary() {\n    return computed<boolean, this>('position', 'parent', (position, parent) => position !== null && parent === false).call(this);\n  }\n}\n","import Tag from '../models/Tag';\n\nexport default function sortTags(tags: Tag[]) {\n  return tags.slice(0).sort((a, b) => {\n    const aPos = a.position();\n    const bPos = b.position();\n\n    // If they're both secondary tags, sort them by their discussions count,\n    // descending.\n    if (aPos === null && bPos === null) return b.discussionCount() - a.discussionCount();\n\n    // If just one is a secondary tag, then the primary tag should\n    // come first.\n    if (bPos === null) return -1;\n    if (aPos === null) return 1;\n\n    // If we've made it this far, we know they're both primary tags. So we'll\n    // need to see if they have parents.\n    const aParent = a.parent();\n    const bParent = b.parent();\n\n    // If they both have the same parent, then their positions are local,\n    // so we can compare them directly.\n    if (aParent === bParent) return aPos - bPos;\n    // If they are both child tags, then we will compare the positions of their\n    // parents.\n    else if (aParent && bParent) return aParent.position()! - bParent.position()!;\n    // If we are comparing a child tag with its parent, then we let the parent\n    // come first. If we are comparing an unrelated parent/child, then we\n    // compare both of the parents.\n    else if (aParent) return aParent === b ? 1 : aParent.position()! - bPos;\n    else if (bParent) return bParent === a ? -1 : aPos - bParent.position()!;\n\n    return 0;\n  });\n}\n","import { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport classList from 'flarum/common/utils/classList';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport getSelectableTags from './utils/getSelectableTags';\n\nexport default function () {\n  extend(IndexPage.prototype, 'newDiscussionAction', function (promise) {\n    // From `addTagFilter\n    const tag = this.currentTag();\n\n    if (tag) {\n      const parent = tag.parent();\n      const tags = parent ? [parent, tag] : [tag];\n      promise.then((composer) => (composer.fields.tags = tags));\n    } else {\n      app.composer.fields.tags = [];\n    }\n  });\n\n  extend(DiscussionComposer.prototype, 'oninit', function () {\n    app.tagList.load(['parent']).then(() => m.redraw());\n  });\n\n  // Add tag-selection abilities to the discussion composer.\n  DiscussionComposer.prototype.chooseTags = function () {\n    const selectableTags = getSelectableTags();\n\n    if (!selectableTags.length) return;\n\n    app.modal.show(TagDiscussionModal, {\n      selectedTags: (this.composer.fields.tags || []).slice(0),\n      onsubmit: (tags) => {\n        this.composer.fields.tags = tags;\n        this.$('textarea').focus();\n      },\n    });\n  };\n\n  // Add a tag-selection menu to the discussion composer's header, after the\n  // title.\n  extend(DiscussionComposer.prototype, 'headerItems', function (items) {\n    const tags = this.composer.fields.tags || [];\n    const selectableTags = getSelectableTags();\n\n    items.add(\n      'tags',\n      <a className={classList(['DiscussionComposer-changeTags', !selectableTags.length && 'disabled'])} onclick={this.chooseTags.bind(this)}>\n        {tags.length ? (\n          tagsLabel(tags)\n        ) : (\n          <span className=\"TagLabel untagged\">{app.translator.trans('flarum-tags.forum.composer_discussion.choose_tags_link')}</span>\n        )}\n      </a>,\n      10\n    );\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function (original) {\n    const chosenTags = this.composer.fields.tags || [];\n    const chosenPrimaryTags = chosenTags.filter((tag) => tag.position() !== null && !tag.isChild());\n    const chosenSecondaryTags = chosenTags.filter((tag) => tag.position() === null);\n    const selectableTags = getSelectableTags();\n\n    const minPrimaryTags = parseInt(app.forum.attribute('minPrimaryTags'));\n    const minSecondaryTags = parseInt(app.forum.attribute('minSecondaryTags'));\n    const maxPrimaryTags = parseInt(app.forum.attribute('maxPrimaryTags'));\n    const maxSecondaryTags = parseInt(app.forum.attribute('maxSecondaryTags'));\n\n    if (\n      ((!chosenTags.length && maxPrimaryTags !== 0 && maxSecondaryTags !== 0) ||\n        chosenPrimaryTags.length < minPrimaryTags ||\n        chosenSecondaryTags.length < minSecondaryTags) &&\n      selectableTags.length\n    ) {\n      app.modal.show(TagDiscussionModal, {\n        selectedTags: chosenTags,\n        onsubmit: (tags) => {\n          this.composer.fields.tags = tags;\n          original();\n        },\n      });\n    } else {\n      original();\n    }\n  });\n\n  // Add the selected tags as data to submit to the server.\n  extend(DiscussionComposer.prototype, 'data', function (data) {\n    data.relationships = data.relationships || {};\n    data.relationships.tags = this.composer.fields.tags;\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport Button from 'flarum/common/components/Button';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\n\nexport default function () {\n  // Add a control allowing the discussion to be moved to another category.\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canTag()) {\n      items.add(\n        'tags',\n        <Button icon=\"fas fa-tag\" onclick={() => app.modal.show(TagDiscussionModal, { discussion })}>\n          {app.translator.trans('flarum-tags.forum.discussion_controls.edit_tags_button')}\n        </Button>\n      );\n    }\n  });\n}\n","import app from 'flarum/forum/app';\nimport type Mithril from 'mithril';\nimport { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport GlobalSearchState from 'flarum/forum/states/GlobalSearchState';\nimport classList from 'flarum/common/utils/classList';\nimport isDark from 'flarum/common/utils/isDark';\n\nimport TagHero from './components/TagHero';\nimport Tag from '../common/models/Tag';\nimport { ComponentAttrs } from 'flarum/common/Component';\n\nconst findTag = (slug: string) => app.store.all<Tag>('tags').find((tag) => tag.slug().localeCompare(slug, undefined, { sensitivity: 'base' }) === 0);\n\nexport default function () {\n  IndexPage.prototype.currentTag = function () {\n    if (this.currentActiveTag) {\n      return this.currentActiveTag;\n    }\n\n    const slug = app.search.params().tags;\n    let tag = null;\n\n    if (slug) {\n      tag = findTag(slug);\n    }\n\n    if ((slug && !tag) || (tag && !tag.isChild() && !tag.children())) {\n      if (this.currentTagLoading) {\n        return;\n      }\n\n      this.currentTagLoading = true;\n\n      // Unlike the backend, no need to fetch parent.children because if we're on\n      // a child tag page, then either:\n      //    - We loaded in that child tag (and its siblings) in the API document\n      //    - We first navigated to the current tag's parent, which would have loaded in the current tag's siblings.\n      app.store\n        .find('tags', slug, { include: 'children,children.parent,parent,state' })\n        .then(() => {\n          this.currentActiveTag = findTag(slug);\n\n          m.redraw();\n        })\n        .finally(() => {\n          this.currentTagLoading = false;\n        });\n    }\n\n    if (tag) {\n      this.currentActiveTag = tag;\n      return this.currentActiveTag;\n    }\n\n    return;\n  };\n\n  // If currently viewing a tag, insert a tag hero at the top of the view.\n  override(IndexPage.prototype, 'hero', function (original) {\n    const tag = this.currentTag();\n\n    if (tag) return <TagHero model={tag} />;\n\n    return original();\n  });\n\n  extend(IndexPage.prototype, 'view', function (vdom: Mithril.Vnode<ComponentAttrs, {}>) {\n    const tag = this.currentTag();\n\n    if (tag) vdom.attrs.className += ' IndexPage--tag' + tag.id();\n  });\n\n  extend(IndexPage.prototype, 'setTitle', function () {\n    const tag = this.currentTag();\n\n    if (tag) {\n      app.setTitle(tag.name());\n    }\n  });\n\n  // If currently viewing a tag, restyle the 'new discussion' button to use\n  // the tag's color, and disable if the user isn't allowed to edit.\n  extend(IndexPage.prototype, 'sidebarItems', function (items) {\n    const tag = this.currentTag();\n\n    if (tag) {\n      const color = tag.color();\n      const canStartDiscussion = tag.canStartDiscussion() || !app.session.user;\n      const newDiscussion = items.get('newDiscussion') as Mithril.Vnode<ComponentAttrs, {}>;\n\n      if (color) {\n        newDiscussion.attrs.className = classList([newDiscussion.attrs.className, 'Button--tagColored']);\n        newDiscussion.attrs.style = { '--color': color };\n\n        if (isDark(color)) {\n        newDiscussion.attrs.className = classList([newDiscussion.attrs.className, 'Button--tagDark']);\n        }\n        else {\n        newDiscussion.attrs.className = classList([newDiscussion.attrs.className, 'Button--tagLight']);\n        }\n      }\n\n      newDiscussion.attrs.disabled = !canStartDiscussion;\n      newDiscussion.children = app.translator.trans(\n        canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'\n      );\n    }\n  });\n\n  // Add a parameter for the global search state to pass on to the\n  // DiscussionListState that will let us filter discussions by tag.\n  extend(GlobalSearchState.prototype, 'params', function (params) {\n    params.tags = m.route.param('tags');\n  });\n\n  // Translate that parameter into a gambit appended to the search query.\n  extend(DiscussionListState.prototype, 'requestParams', function (this: DiscussionListState, params) {\n    if (typeof params.include === 'string') {\n      params.include = [params.include];\n    } else {\n      params.include?.push('tags', 'tags.parent');\n    }\n\n    if (this.params.tags) {\n      const filter = params.filter ?? {};\n      filter.tag = this.params.tags;\n      // TODO: replace this with a more robust system.\n      const q = filter.q;\n      if (q) {\n        filter.q = `${q} tag:${this.params.tags}`;\n      }\n      params.filter = filter;\n    }\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport isDark from 'flarum/common/utils/isDark';\n\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function () {\n  // Add tag labels to each discussion in the discussion list.\n  extend(DiscussionListItem.prototype, 'infoItems', function (items) {\n    const tags = this.attrs.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags), 10);\n    }\n  });\n\n  // Restyle a discussion's hero to use its first tag's color.\n  extend(DiscussionHero.prototype, 'view', function (view) {\n    const tags = sortTags(this.attrs.discussion.tags());\n\n    if (tags && tags.length) {\n      const color = tags[0].color();\n      if (color) {\n        view.attrs.style = { '--hero-bg': color };\n\n        if (isDark(color)) {\n          view.attrs.className += ' DiscussionHero--dark';\n        }\n        else {\n          view.attrs.className += ' DiscussionHero--light';\n        }\n      }\n    }\n  });\n\n  // Add a list of a discussion's tags to the discussion hero, displayed\n  // before the title. Put the title on its own line.\n  extend(DiscussionHero.prototype, 'items', function (items) {\n    const tags = this.attrs.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags, { link: true }), 5);\n    }\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Separator from 'flarum/common/components/Separator';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nimport TagLinkButton from './components/TagLinkButton';\nimport TagsPage from './components/TagsPage';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function () {\n  // Add a link to the tags page, as well as a list of all the tags,\n  // to the index page's sidebar.\n  extend(IndexPage.prototype, 'navItems', function (items) {\n    items.add(\n      'tags',\n      <LinkButton icon=\"fas fa-th-large\" href={app.route('tags')}>\n        {app.translator.trans('flarum-tags.forum.index.tags_link')}\n      </LinkButton>,\n      -10\n    );\n\n    if (app.current.matches(TagsPage)) return;\n\n    items.add('separator', Separator.component(), -12);\n\n    const params = app.search.stickyParams();\n    const tags = app.store.all('tags');\n    const currentTag = this.currentTag();\n\n    const addTag = (tag) => {\n      let active = currentTag === tag;\n\n      if (!active && currentTag) {\n        active = currentTag.parent() === tag;\n      }\n\n      // tag.name() is passed here as children even though it isn't used directly\n      // because when we need to get the active child in SelectDropdown, we need to\n      // use its children to populate the dropdown. The problem here is that `view`\n      // on TagLinkButton is only called AFTER SelectDropdown, so no children are available\n      // for SelectDropdown to use at the time.\n      items.add('tag' + tag.id(), TagLinkButton.component({ model: tag, params, active }, tag?.name()), -14);\n    };\n\n    sortTags(tags)\n      .filter(\n        (tag) => tag.position() !== null && (!tag.isChild() || (currentTag && (tag.parent() === currentTag || tag.parent() === currentTag.parent())))\n      )\n      .forEach(addTag);\n\n    const more = tags.filter((tag) => tag.position() === null).sort((a, b) => b.discussionCount() - a.discussionCount());\n\n    more.splice(0, 3).forEach(addTag);\n\n    if (more.length) {\n      items.add('moreTags', <LinkButton href={app.route('tags')}>{app.translator.trans('flarum-tags.forum.index.more_link')}</LinkButton>, -16);\n    }\n  });\n}\n","import compat from '../common/compat';\n\nimport addTagFilter from './addTagFilter';\nimport addTagControl from './addTagControl';\nimport TagHero from './components/TagHero';\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\nimport TagLinkButton from './components/TagLinkButton';\nimport addTagList from './addTagList';\nimport addTagLabels from './addTagLabels';\nimport addTagComposer from './addTagComposer';\nimport getSelectableTags from './utils/getSelectableTags';\n\nexport default Object.assign(compat, {\n  'tags/addTagFilter': addTagFilter,\n  'tags/addTagControl': addTagControl,\n  'tags/components/TagHero': TagHero,\n  'tags/components/TagDiscussionModal': TagDiscussionModal,\n  'tags/components/TagsPage': TagsPage,\n  'tags/components/DiscussionTaggedPost': DiscussionTaggedPost,\n  'tags/components/TagLinkButton': TagLinkButton,\n  'tags/addTagList': addTagList,\n  'tags/addTagLabels': addTagLabels,\n  'tags/addTagComposer': addTagComposer,\n  'tags/utils/getSelectableTags': getSelectableTags,\n});\n","import EventPost from 'flarum/forum/components/EventPost';\nimport tagsLabel from '../../common/helpers/tagsLabel';\n\nexport default class DiscussionTaggedPost extends EventPost {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    const oldTags = attrs.post.content()[0];\n    const newTags = attrs.post.content()[1];\n\n    function diffTags(tags1, tags2) {\n      return tags1.filter((tag) => tags2.indexOf(tag) === -1).map((id) => app.store.getById('tags', id));\n    }\n\n    attrs.tagsAdded = diffTags(newTags, oldTags);\n    attrs.tagsRemoved = diffTags(oldTags, newTags);\n  }\n\n  icon() {\n    return 'fas fa-tag';\n  }\n\n  descriptionKey() {\n    if (this.attrs.tagsAdded.length) {\n      if (this.attrs.tagsRemoved.length) {\n        return 'flarum-tags.forum.post_stream.added_and_removed_tags_text';\n      }\n\n      return 'flarum-tags.forum.post_stream.added_tags_text';\n    }\n\n    return 'flarum-tags.forum.post_stream.removed_tags_text';\n  }\n\n  descriptionData() {\n    const data = {};\n\n    if (this.attrs.tagsAdded.length) {\n      data.tagsAdded = app.translator.trans('flarum-tags.forum.post_stream.tags_text', {\n        tags: tagsLabel(this.attrs.tagsAdded, { link: true }),\n        count: this.attrs.tagsAdded.length,\n      });\n    }\n\n    if (this.attrs.tagsRemoved.length) {\n      data.tagsRemoved = app.translator.trans('flarum-tags.forum.post_stream.tags_text', {\n        tags: tagsLabel(this.attrs.tagsRemoved, { link: true }),\n        count: this.attrs.tagsRemoved.length,\n      });\n    }\n\n    return data;\n  }\n}\n","import app from 'flarum/forum/app';\nimport type Mithril from 'mithril';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport highlight from 'flarum/common/helpers/highlight';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport KeyboardNavigatable from 'flarum/forum/utils/KeyboardNavigatable';\nimport Stream from 'flarum/common/utils/Stream';\nimport Discussion from 'flarum/common/models/Discussion';\n\nimport tagLabel from '../../common/helpers/tagLabel';\nimport tagIcon from '../../common/helpers/tagIcon';\nimport sortTags from '../../common/utils/sortTags';\nimport getSelectableTags from '../utils/getSelectableTags';\nimport ToggleButton from './ToggleButton';\nimport Tag from '../../common/models/Tag';\n\nexport interface TagDiscussionModalAttrs extends IInternalModalAttrs {\n  discussion?: Discussion;\n  selectedTags?: Tag[];\n  onsubmit?: (tags: Tag[]) => {};\n}\n\nexport default class TagDiscussionModal extends Modal<TagDiscussionModalAttrs> {\n  tagsLoading = true;\n\n  selected: Tag[] = [];\n  filter = Stream('');\n  focused = false;\n\n  minPrimary = app.forum.attribute<number>('minPrimaryTags');\n  maxPrimary = app.forum.attribute<number>('maxPrimaryTags');\n  minSecondary = app.forum.attribute<number>('minSecondaryTags');\n  maxSecondary = app.forum.attribute<number>('maxSecondaryTags');\n\n  bypassReqs = false;\n\n  navigator = new KeyboardNavigatable();\n\n  tags?: Tag[];\n\n  selectedTag?: Tag;\n  oninit(vnode: Mithril.Vnode<TagDiscussionModalAttrs, this>) {\n    super.oninit(vnode);\n\n    this.navigator\n      .onUp(() => this.setIndex(this.getCurrentNumericIndex() - 1, true))\n      .onDown(() => this.setIndex(this.getCurrentNumericIndex() + 1, true))\n      .onSelect(this.select.bind(this))\n      .onRemove(() => this.selected.splice(this.selected.length - 1, 1));\n\n    app.tagList.load(['parent']).then(() => {\n      this.tagsLoading = false;\n\n      const tags = sortTags(getSelectableTags(this.attrs.discussion));\n      this.tags = tags;\n\n      const discussionTags = this.attrs.discussion?.tags();\n      if (this.attrs.selectedTags) {\n        this.attrs.selectedTags.map(this.addTag.bind(this));\n      } else if (discussionTags) {\n        discussionTags.forEach((tag) => tag && this.addTag(tag));\n      }\n\n      this.selectedTag = tags[0];\n\n      m.redraw();\n    });\n  }\n\n  primaryCount() {\n    return this.selected.filter((tag) => tag.isPrimary()).length;\n  }\n\n  secondaryCount() {\n    return this.selected.filter((tag) => !tag.isPrimary()).length;\n  }\n\n  /**\n   * Add the given tag to the list of selected tags.\n   */\n  addTag(tag: Tag) {\n    if (!tag.canStartDiscussion()) return;\n\n    // If this tag has a parent, we'll also need to add the parent tag to the\n    // selected list if it's not already in there.\n    const parent = tag.parent();\n    if (parent && !this.selected.includes(parent)) {\n      this.selected.push(parent);\n    }\n\n    if (!this.selected.includes(tag)) {\n      this.selected.push(tag);\n    }\n  }\n\n  /**\n   * Remove the given tag from the list of selected tags.\n   */\n  removeTag(tag: Tag) {\n    const index = this.selected.indexOf(tag);\n    if (index !== -1) {\n      this.selected.splice(index, 1);\n\n      // Look through the list of selected tags for any tags which have the tag\n      // we just removed as their parent. We'll need to remove them too.\n      this.selected.filter((selected) => selected.parent() === tag).forEach(this.removeTag.bind(this));\n    }\n  }\n\n  className() {\n    return 'TagDiscussionModal';\n  }\n\n  title() {\n    return this.attrs.discussion\n      ? app.translator.trans('flarum-tags.forum.choose_tags.edit_title', { title: <em>{this.attrs.discussion.title()}</em> })\n      : app.translator.trans('flarum-tags.forum.choose_tags.title');\n  }\n\n  getInstruction(primaryCount: number, secondaryCount: number) {\n    if (this.bypassReqs) {\n      return '';\n    }\n\n    if (primaryCount < this.minPrimary) {\n      const remaining = this.minPrimary - primaryCount;\n      return app.translator.trans('flarum-tags.forum.choose_tags.choose_primary_placeholder', { count: remaining });\n    } else if (secondaryCount < this.minSecondary) {\n      const remaining = this.minSecondary - secondaryCount;\n      return app.translator.trans('flarum-tags.forum.choose_tags.choose_secondary_placeholder', { count: remaining });\n    }\n\n    return '';\n  }\n\n  content() {\n    if (this.tagsLoading || !this.tags) {\n      return <LoadingIndicator />;\n    }\n\n    let tags = this.tags;\n    const filter = this.filter().toLowerCase();\n    const primaryCount = this.primaryCount();\n    const secondaryCount = this.secondaryCount();\n\n    // Filter out all child tags whose parents have not been selected. This\n    // makes it impossible to select a child if its parent hasn't been selected.\n    tags = tags.filter((tag) => {\n      const parent = tag.parent();\n      return parent !== null && (parent === false || this.selected.includes(parent));\n    });\n\n    // If the number of selected primary/secondary tags is at the maximum, then\n    // we'll filter out all other tags of that type.\n    if (primaryCount >= this.maxPrimary && !this.bypassReqs) {\n      tags = tags.filter((tag) => !tag.isPrimary() || this.selected.includes(tag));\n    }\n\n    if (secondaryCount >= this.maxSecondary && !this.bypassReqs) {\n      tags = tags.filter((tag) => tag.isPrimary() || this.selected.includes(tag));\n    }\n\n    // If the user has entered text in the filter input, then filter by tags\n    // whose name matches what they've entered.\n    if (filter) {\n      tags = tags.filter((tag) => tag.name().substr(0, filter.length).toLowerCase() === filter);\n    }\n\n    if (!this.selectedTag || !tags.includes(this.selectedTag)) this.selectedTag = tags[0];\n\n    const inputWidth = Math.max(extractText(this.getInstruction(primaryCount, secondaryCount)).length, this.filter().length);\n\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"TagDiscussionModal-form\">\n          <div className=\"TagDiscussionModal-form-input\">\n            <div className={'TagsInput FormControl ' + (this.focused ? 'focus' : '')} onclick={() => this.$('.TagsInput input').focus()}>\n              <span className=\"TagsInput-selected\">\n                {this.selected.map((tag) => (\n                  <span\n                    className=\"TagsInput-tag\"\n                    onclick={() => {\n                      this.removeTag(tag);\n                      this.onready();\n                    }}\n                  >\n                    {tagLabel(tag)}\n                  </span>\n                ))}\n              </span>\n              <input\n                className=\"FormControl\"\n                placeholder={extractText(this.getInstruction(primaryCount, secondaryCount))}\n                bidi={this.filter}\n                style={{ width: inputWidth + 'ch' }}\n                onkeydown={this.navigator.navigate.bind(this.navigator)}\n                onfocus={() => (this.focused = true)}\n                onblur={() => (this.focused = false)}\n              />\n            </div>\n          </div>\n          <div className=\"TagDiscussionModal-form-submit App-primaryControl\">\n            <Button\n              type=\"submit\"\n              className=\"Button Button--primary\"\n              disabled={!this.meetsRequirements(primaryCount, secondaryCount)}\n              icon=\"fas fa-check\"\n            >\n              {app.translator.trans('flarum-tags.forum.choose_tags.submit_button')}\n            </Button>\n          </div>\n        </div>\n      </div>,\n\n      <div className=\"Modal-footer\">\n        <ul className=\"TagDiscussionModal-list SelectTagList\">\n          {tags\n            .filter((tag) => filter || !tag.parent() || this.selected.includes(tag.parent() as Tag))\n            .map((tag) => (\n              <li\n                data-index={tag.id()}\n                className={classList({\n                  pinned: tag.position() !== null,\n                  child: !!tag.parent(),\n                  colored: !!tag.color(),\n                  selected: this.selected.includes(tag),\n                  active: this.selectedTag === tag,\n                })}\n                style={{ color: tag.color() }}\n                onmouseover={() => (this.selectedTag = tag)}\n                onclick={this.toggleTag.bind(this, tag)}\n              >\n                {tagIcon(tag)}\n                <span className=\"SelectTagListItem-name\">{highlight(tag.name(), filter)}</span>\n                {tag.description() ? <span className=\"SelectTagListItem-description\">{tag.description()}</span> : ''}\n              </li>\n            ))}\n        </ul>\n        {!!app.forum.attribute('canBypassTagCounts') && (\n          <div className=\"TagDiscussionModal-controls\">\n            <ToggleButton className=\"Button\" onclick={() => (this.bypassReqs = !this.bypassReqs)} isToggled={this.bypassReqs}>\n              {app.translator.trans('flarum-tags.forum.choose_tags.bypass_requirements')}\n            </ToggleButton>\n          </div>\n        )}\n      </div>,\n    ];\n  }\n\n  meetsRequirements(primaryCount: number, secondaryCount: number) {\n    if (this.bypassReqs) {\n      return true;\n    }\n\n    return primaryCount >= this.minPrimary && secondaryCount >= this.minSecondary;\n  }\n\n  toggleTag(tag: Tag) {\n    // Won't happen, needed for type safety.\n    if (!this.tags) return;\n\n    if (this.selected.includes(tag)) {\n      this.removeTag(tag);\n    } else {\n      this.addTag(tag);\n    }\n\n    if (this.filter()) {\n      this.filter('');\n      this.selectedTag = this.tags[0];\n    }\n\n    this.onready();\n  }\n\n  select(e: KeyboardEvent) {\n    // Ctrl + Enter submits the selection, just Enter completes the current entry\n    if (e.metaKey || e.ctrlKey || (this.selectedTag && this.selected.includes(this.selectedTag))) {\n      if (this.selected.length) {\n        // The DOM submit method doesn't emit a `submit event, so we\n        // simulate a manual submission so our `onsubmit` logic is run.\n        this.$('button[type=\"submit\"]').click();\n      }\n    } else if (this.selectedTag) {\n      this.getItem(this.selectedTag)[0].dispatchEvent(new Event('click'));\n    }\n  }\n\n  selectableItems() {\n    return this.$('.TagDiscussionModal-list > li');\n  }\n\n  getCurrentNumericIndex() {\n    if (!this.selectedTag) return -1;\n\n    return this.selectableItems().index(this.getItem(this.selectedTag));\n  }\n\n  getItem(selectedTag: Tag) {\n    return this.selectableItems().filter(`[data-index=\"${selectedTag.id()}\"]`);\n  }\n\n  setIndex(index: number, scrollToItem: boolean) {\n    const $items = this.selectableItems();\n    const $dropdown = $items.parent();\n\n    if (index < 0) {\n      index = $items.length - 1;\n    } else if (index >= $items.length) {\n      index = 0;\n    }\n\n    const $item = $items.eq(index);\n\n    this.selectedTag = app.store.getById('tags', $item.attr('data-index')!);\n\n    m.redraw();\n\n    if (scrollToItem && this.selectedTag) {\n      const dropdownScroll = $dropdown.scrollTop()!;\n      const dropdownTop = $dropdown.offset()!.top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight()!;\n      const itemTop = $item.offset()!.top;\n      const itemBottom = itemTop + $item.outerHeight()!;\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n\n  onsubmit(e: SubmitEvent) {\n    e.preventDefault();\n\n    const discussion = this.attrs.discussion;\n    const tags = this.selected;\n\n    if (discussion) {\n      discussion.save({ relationships: { tags } }).then(() => {\n        if (app.current.matches(DiscussionPage)) {\n          app.current.get('stream').update();\n        }\n        m.redraw();\n      });\n    }\n\n    if (this.attrs.onsubmit) this.attrs.onsubmit(tags);\n\n    this.hide();\n  }\n}\n","import Component from 'flarum/common/Component';\nimport isDark from 'flarum/common/utils/isDark';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagHero extends Component {\n  view() {\n    const tag = this.attrs.model;\n    const color = tag.color();\n\n    return (\n      <header className={'Hero TagHero' + (color ? ' TagHero--colored' : '') + (isDark(color) ? ' TagHero--dark' : ' TagHero--light')} style={color ? { '--hero-bg': color } : ''}>\n        <div className=\"container\">\n          <div className=\"containerNarrow\">\n            <h2 className=\"Hero-title\">\n              {tag.icon() && tagIcon(tag, {}, { useColor: false })} {tag.name()}\n            </h2>\n            <div className=\"Hero-subtitle\">{tag.description()}</div>\n          </div>\n        </div>\n      </header>\n    );\n  }\n}\n","import Link from 'flarum/common/components/Link';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport classList from 'flarum/common/utils/classList';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagLinkButton extends LinkButton {\n  view(vnode) {\n    const tag = this.attrs.model;\n    const active = this.constructor.isActive(this.attrs);\n    const description = tag && tag.description();\n    const className = classList(['TagLinkButton', 'hasIcon', this.attrs.className, tag.isChild() && 'child']);\n\n    return (\n      <Link className={className} href={this.attrs.route} style={tag ? { '--color': tag.color() } : ''} title={description || ''}>\n        {tagIcon(tag, { className: 'Button-icon' })}\n        <span className=\"Button-label\">{tag ? tag.name() : app.translator.trans('flarum-tags.forum.index.untagged_link')}</span>\n      </Link>\n    );\n  }\n\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    const tag = attrs.model;\n\n    attrs.params.tags = tag ? tag.slug() : 'untagged';\n    attrs.route = app.route('tag', attrs.params);\n  }\n}\n","import Page from 'flarum/common/components/Page';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Link from 'flarum/common/components/Link';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport listItems from 'flarum/common/helpers/listItems';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport isDark from 'flarum/common/utils/isDark';\n\nimport tagIcon from '../../common/helpers/tagIcon';\nimport tagLabel from '../../common/helpers/tagLabel';\nimport sortTags from '../../common/utils/sortTags';\n\nexport default class TagsPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.history.push('tags', app.translator.trans('flarum-tags.forum.header.back_to_tags_tooltip'));\n\n    this.tags = [];\n\n    const preloaded = app.preloadedApiDocument();\n\n    if (preloaded) {\n      this.tags = sortTags(preloaded.filter((tag) => !tag.isChild()));\n      return;\n    }\n\n    this.loading = true;\n\n    app.tagList.load(['children', 'lastPostedDiscussion', 'parent']).then(() => {\n      this.tags = sortTags(app.store.all('tags').filter((tag) => !tag.isChild()));\n\n      this.loading = false;\n\n      m.redraw();\n    });\n  }\n\n  view() {\n    if (this.loading) {\n      return <LoadingIndicator />;\n    }\n\n    const pinned = this.tags.filter((tag) => tag.position() !== null);\n    const cloud = this.tags.filter((tag) => tag.position() === null);\n\n    return (\n      <div className=\"TagsPage\">\n        {IndexPage.prototype.hero()}\n        <div className=\"container\">\n          <nav className=\"TagsPage-nav IndexPage-nav sideNav\">\n            <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\n          </nav>\n\n          <div className=\"TagsPage-content sideNavOffset\">\n            <ul className=\"TagTiles\">\n              {pinned.map((tag) => {\n                const lastPostedDiscussion = tag.lastPostedDiscussion();\n                const children = sortTags(tag.children() || []);\n\n                return (\n                    <li className={'TagTile ' + (tag.color() ? 'colored ' : '') + (isDark(tag.color()) ? 'tag-dark' : 'tag-light')} style={{ '--tag-bg': tag.color() }}>\n                    <Link className=\"TagTile-info\" href={app.route.tag(tag)}>\n                      {tag.icon() && tagIcon(tag, {}, { useColor: false })}\n                      <h3 className=\"TagTile-name\">{tag.name()}</h3>\n                      <p className=\"TagTile-description\">{tag.description()}</p>\n                      {children ? (\n                        <div className=\"TagTile-children\">\n                          {children.map((child) => [<Link href={app.route.tag(child)}>{child.name()}</Link>, ' '])}\n                        </div>\n                      ) : (\n                        ''\n                      )}\n                    </Link>\n                    {lastPostedDiscussion ? (\n                      <Link\n                        className=\"TagTile-lastPostedDiscussion\"\n                        href={app.route.discussion(lastPostedDiscussion, lastPostedDiscussion.lastPostNumber())}\n                      >\n                        <span className=\"TagTile-lastPostedDiscussion-title\">{lastPostedDiscussion.title()}</span>\n                        {humanTime(lastPostedDiscussion.lastPostedAt())}\n                      </Link>\n                    ) : (\n                      <span className=\"TagTile-lastPostedDiscussion\" />\n                    )}\n                  </li>\n                );\n              })}\n            </ul>\n\n            {cloud.length ? <div className=\"TagCloud\">{cloud.map((tag) => [tagLabel(tag, { link: true }), ' '])}</div> : ''}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    app.setTitle(app.translator.trans('flarum-tags.forum.all_tags.meta_title_text'));\n    app.setTitleCount(0);\n  }\n}\n","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\n\n/**\n * @TODO move to core\n */\nexport default class ToggleButton extends Component {\n  view(vnode) {\n    const { className, isToggled, ...attrs } = this.attrs;\n    const icon = isToggled ? 'far fa-check-circle' : 'far fa-circle';\n\n    return (\n      <Button {...attrs} icon={icon} className={classList([className, isToggled && 'Button--toggled'])}>\n        {vnode.children}\n      </Button>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Discussion from 'flarum/common/models/Discussion';\nimport IndexPage from 'flarum/forum/components/IndexPage';\n\nimport Tag from '../common/models/Tag';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\n\nimport TagListState from './states/TagListState';\n\nimport addTagList from './addTagList';\nimport addTagFilter from './addTagFilter';\nimport addTagLabels from './addTagLabels';\nimport addTagControl from './addTagControl';\nimport addTagComposer from './addTagComposer';\n\napp.initializers.add('flarum-tags', function () {\n  app.routes.tags = { path: '/tags', component: TagsPage };\n  app.routes.tag = { path: '/t/:tags', component: IndexPage };\n\n  app.route.tag = (tag: Tag) => app.route('tag', { tags: tag.slug() });\n\n  app.postComponents.discussionTagged = DiscussionTaggedPost;\n\n  app.store.models.tags = Tag;\n\n  app.tagList = new TagListState();\n\n  Discussion.prototype.tags = Model.hasMany<Tag>('tags');\n  Discussion.prototype.canTag = Model.attribute<boolean>('canTag');\n\n  addTagList();\n  addTagFilter();\n  addTagLabels();\n  addTagControl();\n  addTagComposer();\n});\n\n// Expose compat API\nimport tagsCompat from './compat';\nimport { compat } from '@flarum/core/forum';\n\nObject.assign(compat, tagsCompat);\n","import app from 'flarum/forum/app';\nimport type Tag from '../../common/models/Tag';\n\nexport default class TagListState {\n  loadedIncludes = new Set();\n\n  async load(includes: string[] = []): Promise<Tag[]> {\n    const unloadedIncludes = includes.filter((include) => !this.loadedIncludes.has(include));\n\n    if (unloadedIncludes.length === 0) {\n      return Promise.resolve(app.store.all<Tag>('tags'));\n    }\n\n    return app.store.find<Tag[]>('tags', { include: unloadedIncludes.join(',') }).then((val) => {\n      unloadedIncludes.forEach((include) => this.loadedIncludes.add(include));\n      return val;\n    });\n  }\n}\n","export default function getSelectableTags(discussion) {\n  let tags = app.store.all('tags');\n\n  if (discussion) {\n    tags = tags.filter((tag) => tag.canAddToDiscussion() || discussion.tags().indexOf(tag) !== -1);\n  } else {\n    tags = tags.filter((tag) => tag.canStartDiscussion());\n  }\n\n  return tags;\n}\n","module.exports = require(\"regenerator-runtime\");\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","module.exports = flarum.core;","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/components/Separator'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/helpers/highlight'];","module.exports = flarum.core.compat['common/helpers/humanTime'];","module.exports = flarum.core.compat['common/helpers/listItems'];","module.exports = flarum.core.compat['common/models/Discussion'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/utils/computed'];","module.exports = flarum.core.compat['common/utils/extract'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['common/utils/isDark'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/DiscussionComposer'];","module.exports = flarum.core.compat['forum/components/DiscussionHero'];","module.exports = flarum.core.compat['forum/components/DiscussionListItem'];","module.exports = flarum.core.compat['forum/components/DiscussionPage'];","module.exports = flarum.core.compat['forum/components/EventPost'];","module.exports = flarum.core.compat['forum/components/IndexPage'];","module.exports = flarum.core.compat['forum/states/DiscussionListState'];","module.exports = flarum.core.compat['forum/states/GlobalSearchState'];","module.exports = flarum.core.compat['forum/utils/DiscussionControls'];","module.exports = flarum.core.compat['forum/utils/KeyboardNavigatable'];","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './src/common';\nexport * from './src/forum';\n"],"names":["sortTags","Tag","tagsLabel","tagIcon","tagLabel","classList","tag","attrs","settings","hasIcon","icon","useColor","className","style","color","extract","isDark","Link","link","tagText","name","app","translator","trans","title","description","href","route","tags","slug","isChild","m","children","forEach","length","push","computed","Model","attribute","call","backgroundUrl","backgroundMode","position","parent","hasOne","hasMany","defaultSort","isHidden","discussionCount","lastPostedAt","transformDate","lastPostedDiscussion","isRestricted","canStartDiscussion","canAddToDiscussion","isPrimary","slice","sort","a","b","aPos","bPos","aParent","bParent","extend","override","IndexPage","DiscussionComposer","TagDiscussionModal","getSelectableTags","prototype","promise","currentTag","then","composer","fields","tagList","load","redraw","chooseTags","selectableTags","modal","show","selectedTags","onsubmit","$","focus","items","add","bind","original","chosenTags","chosenPrimaryTags","filter","chosenSecondaryTags","minPrimaryTags","parseInt","forum","minSecondaryTags","maxPrimaryTags","maxSecondaryTags","data","relationships","DiscussionControls","Button","discussion","canTag","DiscussionListState","GlobalSearchState","TagHero","findTag","store","all","find","localeCompare","undefined","sensitivity","currentActiveTag","search","params","currentTagLoading","include","vdom","id","setTitle","session","user","newDiscussion","get","disabled","param","q","DiscussionListItem","DiscussionHero","view","Separator","LinkButton","TagLinkButton","TagsPage","current","matches","component","stickyParams","addTag","active","model","more","splice","compat","addTagFilter","addTagControl","DiscussionTaggedPost","addTagList","addTagLabels","addTagComposer","Object","assign","EventPost","initAttrs","oldTags","post","content","newTags","diffTags","tags1","tags2","indexOf","map","getById","tagsAdded","tagsRemoved","descriptionKey","descriptionData","count","Modal","DiscussionPage","LoadingIndicator","highlight","extractText","KeyboardNavigatable","Stream","ToggleButton","tagsLoading","selected","focused","minPrimary","maxPrimary","minSecondary","maxSecondary","bypassReqs","navigator","selectedTag","oninit","vnode","onUp","setIndex","getCurrentNumericIndex","onDown","onSelect","select","onRemove","discussionTags","primaryCount","secondaryCount","includes","removeTag","index","getInstruction","remaining","toLowerCase","substr","inputWidth","Math","max","onready","width","navigate","meetsRequirements","pinned","child","colored","toggleTag","e","metaKey","ctrlKey","click","getItem","dispatchEvent","Event","selectableItems","scrollToItem","$items","$dropdown","$item","eq","attr","dropdownScroll","scrollTop","dropdownTop","offset","top","dropdownBottom","outerHeight","itemTop","itemBottom","css","stop","animate","preventDefault","save","update","hide","Component","constructor","isActive","Page","listItems","humanTime","history","preloaded","preloadedApiDocument","loading","cloud","hero","sidebarItems","toArray","lastPostNumber","oncreate","setTitleCount","isToggled","Discussion","TagListState","initializers","routes","path","postComponents","discussionTagged","models","tagsCompat","loadedIncludes","Set","unloadedIncludes","has","Promise","resolve","join","val","module","exports","require","runtime","Op","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","type","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","displayName","defineIteratorMethods","method","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","reject","record","result","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","iter","next","done","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","keys","object","reverse","pop","iterable","iteratorMethod","isNaN","i","skipTempReset","prev","charAt","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","globalThis","Function","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_inheritsLoose","subClass","superClass","_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","_setPrototypeOf","o","p"],"sourceRoot":""}